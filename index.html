<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Parasite Tapper</title>
  <link rel="stylesheet" href="style.css" />
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
</head>
<body>
  <!-- Фон и эффект -->
  <div id="floating-virus-container"></div>
  <div id="background-overlay"></div>
  <div class="infect-border"></div>
  <div id="infection-layer" class=""></div>

  <!-- INFECT TAB -->
  <section id="tab-infect" class="tab active">
    <header>
      <div class="header-content">
        <img src="assets/virus.png" class="virus-icon" alt="Virus" />
        <span id="virus-count">0</span>
        <span class="virus-label">viruses</span>
        <!-- Ранг -->
        <div class="rank-display">
          <img id="rank-image" src="assets/rank1.png" alt="Rank Icon" />
          <span id="rank-name">Новичок</span>
        </div>
      </div>
    </header>

    <main class="virus-area">
      <div id="boss-virus-container">
        <div id="boss-virus">
          <button id="infect-button" class="transparent-hitbox"></button>
        </div>
      </div>
    </main>
  </section>

  <!-- MUTATIONS TAB -->
  <section id="tab-mutations" class="tab hidden">
    <main>
      <h2>Mutations</h2>
      <div class="mutations">
        <div class="mutation" data-id="speed">
          <img src="assets/speed.png" />
          <div>
            <strong>Rapid Replication <span class="level" data-id="speed">x0</span></strong>
            <p>COST: 100</p>
          </div>
        </div>
        <div class="mutation" data-id="shield">
          <img src="assets/shield.png" />
          <div>
            <strong>Drug Resistance <span class="level" data-id="shield">x0</span></strong>
            <p>COST: 500</p>
          </div>
        </div>
        <div class="mutation" data-id="stealth">
          <img src="assets/stealth.png" />
          <div>
            <strong>Invisibility <span class="level" data-id="stealth">x0</span></strong>
            <p>COST: 1500</p>
          </div>
        </div>
        <div class="mutation" data-id="autoclick">
          <img src="assets/autoclick.png" />
          <div>
            <strong>Auto Clicker <span class="level" data-id="autoclick">x0</span></strong>
            <p>COST: 200</p>
          </div>
        </div>
      </div>
    </main>
  </section>

  <!-- ACHIEVEMENTS TAB -->
  <section id="tab-achievements" class="tab hidden">
    <main>
      <h2>Achievements</h2>
      <ul id="achievement-list">
        <li id="ach-auto-click" class="locked">🔒 Auto Clicker x10</li>
      </ul>
    </main>
  </section>

  <!-- PROFILE TAB -->
  <section id="tab-profile" class="tab hidden">
    <main><h2>Profile</h2><p>Coming soon: stats, nickname, etc.</p></main>
  </section>

  <!-- SETTINGS TAB -->
  <section id="tab-settings" class="tab hidden">
    <main><h2>Settings</h2><p>Language / Sound / Reset / Help</p></main>
  </section>

  <!-- Всплывающее окно при повышении ранга -->
<div id="rank-popup" class="hidden">
  <img id="rank-popup-img" src="" alt="Rank Popup" />
  <div id="rank-popup-name"></div>
  <button id="rank-popup-ok">OK</button>
</div>


  <!-- Навигация -->
  <footer class="bottom-nav">
    <button class="nav-btn active" data-tab="infect">🦠<span>Infect</span></button>
    <button class="nav-btn" data-tab="mutations">🧬<span>Mutations</span></button>
    <button class="nav-btn" data-tab="achievements">🏆<span>Achievements</span></button>
    <button class="nav-btn" data-tab="profile">👤<span>Profile</span></button>
    <button class="nav-btn" data-tab="settings">⚙️<span>Settings</span></button>
  </footer>

  <!-- JS -->
  <script src="game.js"></script>
  <script src="floating-viruses.js"></script>
  <script>
    if (window.Telegram && Telegram.WebApp) Telegram.WebApp.expand();

    const tabs = document.querySelectorAll('.tab');
    const navButtons = document.querySelectorAll('.nav-btn');

    navButtons.forEach(button => {
      button.addEventListener('click', () => {
        const target = button.dataset.tab;
        tabs.forEach(tab => {
          tab.classList.toggle('active', tab.id === 'tab-' + target);
          tab.classList.toggle('hidden', tab.id !== 'tab-' + target);
        });
        navButtons.forEach(btn => btn.classList.remove('active'));
        button.classList.add('active');
      });
    });

    // Эффект заражения при загрузке
    window.addEventListener("DOMContentLoaded", () => {
      setTimeout(() => {
        const virus = document.querySelector('.tap-virus');
        virus?.classList.add('mutating');
        const border = document.querySelector('.infect-border');
        border.style.display = 'block';
      }, 2000);
    });

    function triggerInfectionEffect() {
      const layer = document.getElementById('infection-layer');
      layer.className = 'infection-effect';
      setTimeout(() => { layer.className = ''; }, 2000);
    }
  </script>
</body>
</html>